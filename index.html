<html>
  <head></head>
  <body>
  <div id='textarea'>
    <textarea id='textarea-0' placeholder='type here..' onchange="textAreaEventListner()"></textarea>  <!-- onchange="textAreaChange()"--> 
    <div id='div-0'></div>
    </div>
  
    <script src="blocksdk.js"></script>
    <script>
      var sdk = new window.sfdc.BlockSDK({
           blockEditorWidth: 600,
           tabs: [
               'htmlblock', 
               'stylingblock' 
           ]
      }
      );
      var localStorageValue = localStorage.getItem('textarea-0-cache') ;
      if(localStorageValue) { 
        document.getElementById('div-0').innerHTML = localStorageValue;
        document.getElementById('textarea-0').value = localStorageValue;
        }
      var textAreaContent ;
      // do something with the sdk
      //functions
      /* function debounce (func, wait, immediate) {
        var timeout;
        return function() {
          var context = this, args = arguments;
          var later = function() {
            timeout = null;
            if (!immediate) func.apply(context, args);
          };
          var callNow = immediate && !timeout;
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
          if (callNow) func.apply(context, args);
        };
      }
      */

      /* sdk.getData( 
          function(textAreaContent) 
          {
            console.log('[debug]: Get Data method' + JSON.stringify(textAreaContent)); //This is not setting any data.
            //setting default values
            document.getElementById('textarea-0').value = textAreaContent + " - set value";
            textAreaChange();
          }
      );  
      sdk.getContent( 
          function(textAreaContent) 
          {
            console.log('[debug]: Get Data method' + JSON.stringify(textAreaContent)); //This is not setting any data.
            //setting default values
            document.getElementById('textarea-0').value = textAreaContent + " - set value";
            textAreaChange();
          }
      );  */
      function textAreaChange() {
        textAreaContent = document.getElementById('textarea-0').value;

        

        console.log('Text Area Change function called.')
        //setting super content (for preview)
        sdk.setSuperContent(textAreaContent); 
        sdk.setContent(textAreaContent); //optional
        sdk.setData({inputText: textAreaContent}); //optional

        console.log('Super Text Content is --> ' + textAreaContent);

      //Setting DIV tag & cache
      document.getElementById('div-0').innerHTML = textAreaContent;
      document.getElementById('textarea-0').value =textAreaContent;
      localStorage.setItem('textarea-0-cache', textAreaContent);
      //printing sdk object
      console.log('SDK object after setting local storage --> ' + JSON.stringify(sdk));


      sdk.getData(function (data) {
        textAreaContent = data.inputText || 'textAreaContent is empty/ not saved';
        //sdk.setSuperContent(textAreaContent);
        document.getElementById('textarea-0').value = localStorage.getItem('textarea-0-cache');;
        document.getElementById('div-0').innerHTML = localStorage.getItem('textarea-0-cache');;
        console.log('Inside getData ' + JSON.stringify(data));
      });
      }

      function textAreaEventListner() {
        //debounce(textAreaChange,500);
        textAreaChange();
      }

      //TODO: get default value if available and set them
      /* var textAreaElement = document.getElementById('textarea-0');
      if (textAreaElement) { 
        textAreaElement.addEventListener("input", te);
      }*/
      //Printing SDK after initilisation
      console.log('SDK object on initilisation--> ' + JSON.stringify(sdk) );


      
      
    </script>
    </body>
</html>